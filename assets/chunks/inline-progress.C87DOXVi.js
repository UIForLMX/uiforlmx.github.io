import{P as x,b as I,c as O,d as S,e as p,S as V,I as E,B as v}from"./theme.D3bKR1VD.js";import{d as M,r as i,c as t,W as N,b as B}from"./framework.BcJo4Wom.js";function m(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!B(e)}const D=M({name:"InlineProgress",props:{data:{type:Object,default:()=>({})},node:{type:Object,default:()=>({})},name:{type:String,default:""},instance:{type:Object,required:!0},t:{type:Function,required:!0},editorProps:{type:Object,default:()=>({})},selectedIds:{type:Array,default:()=>[]}},emits:["updateValue"],setup(e,{emit:b,attrs:y}){const s=i(!1),d=i(!1),l=i(e.data.progress?Math.floor(e.data.progress*100):0);(()=>{var a;d.value=((a=e.instance)==null?void 0:a.isSelectedTask(e.data.id))&&e.data.type==="task"})();const P=a=>{a.stopPropagation()},k=a=>{a.stopPropagation()},h=a=>{a.stopPropagation()},C=()=>{s.value=!0,l.value=e.data.progress?Math.floor(e.data.progress*100):0},j=()=>{setTimeout(()=>{s.value=!1},10)},w=()=>{s.value=!1,b("updateValue",e.data.id,e.name,l.value/100)};return()=>{var a,u,c,g,f;return t("div",{class:"inline-progress",id:e.data.id,onDblclick:P,onKeydown:k,onMousedown:h},[t("div",{class:"inline-progress-content",style:{width:(a=e.editorProps)!=null&&a.dragProgress?"calc(100% - 16px)":"100%"}},[t(x,N(y,{percent:Math.floor(e.data.progress*100),strokeColor:"#3979f9"}),null)]),((u=e.editorProps)==null?void 0:u.dragProgress)&&((g=(c=e.selectedIds)==null?void 0:c.value)==null?void 0:g.length)===1&&e.selectedIds.value[0]===((f=e.data)==null?void 0:f.id)&&t(I,{visible:s.value,"onUpdate:visible":n=>s.value=n,placement:"bottom",trigger:"click",title:e.t("project.wbsEditor.updateProgress"),overlayClassName:"gantt-task-progress-popover","get-popup-container":()=>document.getElementById(e.data.id),align:{offset:[0,-10]}},{default:()=>[t("div",{class:"inline-progress-edit",style:{display:d.value?"block":"none"}},[t(O,{style:{fontSize:"14px",cursor:"pointer"},onClick:C},null)])],content:()=>{let n,o;return t("div",null,[t(S,null,{default:()=>[t(p,{span:14},{default:()=>[t(V,{value:l.value,"onUpdate:value":r=>l.value=r,min:0,max:100},null)]}),t(p,{span:2},{default:()=>[t(E,{value:l.value,"onUpdate:value":r=>l.value=r,style:{width:"85px","margin-left":"10px"},min:0,max:100,step:1,"addon-after":"%",controls:!1},null)]})]}),t("div",{class:"gantt-task-progress-popover-btn"},[t(v,{onClick:j},m(n=e.t("project.wbsEditor.cancel"))?n:{default:()=>[n]}),t(v,{type:"primary",style:{"margin-left":"10px"},onClick:w},m(o=e.t("project.wbsEditor.confirm"))?o:{default:()=>[o]})])])}})])}}});export{D as default};
