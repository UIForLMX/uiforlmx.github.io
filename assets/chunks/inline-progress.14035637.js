import{d as x,f as r,C as t,B as V,a0 as $}from"./framework.3b97cefe.js";import{h as E,b as I,s as M,k as O,l as m,m as S,n as N,e as p}from"../app.94690059.js";import"./theme.e4c10142.js";function b(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!$(e)}const K=x({name:"InlineProgress",props:{data:{type:Object,default:()=>({})},node:{default:()=>({})},name:{type:String,default:""},instance:{type:Object,required:!0},t:{type:Function,required:!0},editorProps:{type:Object,default:()=>({})},selectedIds:{type:Array,default:()=>[]}},emits:["updateValue"],setup(e,{emit:y,attrs:P}){const s=r(!1),i=r(!1),l=r(e.data.progress?Math.floor(e.data.progress*100):0);(()=>{var a;i.value=((a=e.instance)==null?void 0:a.isSelectedTask(e.data.id))&&e.data.type==="task"})();const h=a=>{a.stopPropagation()},k=a=>{a.stopPropagation()},_=a=>{a.stopPropagation()},C=()=>{s.value=!0,l.value=e.data.progress?Math.floor(e.data.progress*100):0},j=()=>{setTimeout(()=>{s.value=!1},10)},w=a=>{s.value=!1,y("updateValue",e.data.id,e.name,l.value/100)};return()=>{var a,u,c,f,g,v;return t("div",{class:"inline-progress",id:e.data.id,onDblclick:h,onKeydown:k,onMousedown:_},[t("div",{class:"inline-progress-content",style:{width:(a=e.editorProps)!=null&&a.dragProgress?"calc(100% - 16px)":"100%"}},[t(E,V(P,{percent:Math.floor(e.data.progress*100),strokeColor:"#3979f9"}),null)]),((u=e.editorProps)==null?void 0:u.dragProgress)&&((f=(c=e.selectedIds)==null?void 0:c.value)==null?void 0:f.length)===1&&((g=e.selectedIds)==null?void 0:g.value[0])===((v=e.data)==null?void 0:v.id)&&t(I,{visible:s.value,"onUpdate:visible":n=>s.value=n,placement:"bottom",trigger:"click",title:e.t("project.wbsEditor.updateProgress"),overlayClassName:"gantt-task-progress-popover",getPopupContainer:()=>document.getElementById(e.data.id),align:{offset:[0,-10]}},{default:()=>[t("div",{class:"inline-progress-edit",style:{display:i.value?"block":"none"}},[t(M,{name:"hoteam-rename",size:14,onClick:C},null)])],content:()=>{let n,o;return t("div",null,[t(O,null,{default:()=>[t(m,{span:14},{default:()=>[t(S,{value:l.value,"onUpdate:value":d=>l.value=d,min:0,max:100},null)]}),t(m,{span:2},{default:()=>[t(N,{value:l.value,"onUpdate:value":d=>l.value=d,style:{width:"85px","margin-left":"10px"},min:0,max:100,step:1,"addon-after":"%",controls:!1},null)]})]}),t("div",{class:"gantt-task-progress-popover-btn"},[t(p,{onClick:j},b(n=e.t("project.wbsEditor.cancel"))?n:{default:()=>[n]}),t(p,{type:"primary",style:{"margin-left":"10px"},onClick:w},b(o=e.t("project.wbsEditor.confirm"))?o:{default:()=>[o]})])])}})])}}});export{K as default};
