import{a1 as o,V as r,W as p,a6 as a,G as i,k as l,$ as e,au as t,ab as d}from"./chunks/framework.CAZI9hYZ.js";const R=JSON.parse('{"title":"版本发布","description":"","frontmatter":{},"headers":[],"relativePath":"more/version-publish.md","filePath":"more/version-publish.md","lastUpdated":1733380659000}'),u={name:"more/version-publish.md"},h={id:"name",tabindex:"-1"},k={id:"version",tabindex:"-1"},b={id:"main",tabindex:"-1"},g={id:"license",tabindex:"-1"},m={id:"files",tabindex:"-1"},E={id:"publishconfig",tabindex:"-1"},c={id:"description",tabindex:"-1"},f={id:"keywords",tabindex:"-1"},q={id:"repository",tabindex:"-1"},y={id:"homepage",tabindex:"-1"},F={id:"bugs",tabindex:"-1"},v={id:"engines",tabindex:"-1"};function C(x,s,P,j,B,N){const n=d("font");return r(),p("div",null,[s[38]||(s[38]=a("h1",{id:"版本发布",tabindex:"-1"},[i("版本发布 "),a("a",{class:"header-anchor",href:"#版本发布","aria-label":'Permalink to "版本发布"'},"​")],-1)),s[39]||(s[39]=a("h2",{id:"package-json-必要字段",tabindex:"-1"},[i("package.json 必要字段 "),a("a",{class:"header-anchor",href:"#package-json-必要字段","aria-label":'Permalink to "package.json 必要字段"'},"​")],-1)),a("h3",h,[l(n,{color:"#f14158"},{default:e(()=>s[0]||(s[0]=[i("name")])),_:1}),s[1]||(s[1]=i()),s[2]||(s[2]=a("a",{class:"header-anchor",href:"#name","aria-label":`Permalink to "<font color='#f14158'>name</font>"`},"​",-1))]),s[40]||(s[40]=a("ul",null,[a("li",null,"包名，必须是全局唯一"),a("li",null,[i("如果是 "),a("code",null,"Scoped"),i(" 包，格式为 "),a("code",null,"@scope/包名")]),a("li",null,[i("包名必须符合以下规则： "),a("ul",null,[a("li",null,"只能包含小写字母、数字、连字符（-）"),a("li",null,"不允许以 . 或 _ 开头")])])],-1)),a("h3",k,[l(n,{color:"#f14158"},{default:e(()=>s[3]||(s[3]=[i("version")])),_:1}),s[4]||(s[4]=i()),s[5]||(s[5]=a("a",{class:"header-anchor",href:"#version","aria-label":`Permalink to "<font color='#f14158'>version</font>"`},"​",-1))]),s[41]||(s[41]=a("ul",null,[a("li",null,"当前包的版本号，必须符合 语义化版本规范 (SemVer)"),a("li",null,[i("格式："),a("code",null,"主版本号.次版本号.修订号"),i("，如 1.0.0")])],-1)),a("h3",b,[l(n,{color:"#f14158"},{default:e(()=>s[6]||(s[6]=[i("main")])),_:1}),s[7]||(s[7]=i()),s[8]||(s[8]=a("a",{class:"header-anchor",href:"#main","aria-label":`Permalink to "<font color='#f14158'>main</font>"`},"​",-1))]),s[42]||(s[42]=a("ul",null,[a("li",null,"包的入口文件路径（相对于项目根目录）"),a("li",null,[i("如果是模块化项目，可用 "),a("code",null,"exports"),i(" 字段定义多个入口点")])],-1)),a("h3",g,[l(n,{color:"#f14158"},{default:e(()=>s[9]||(s[9]=[i("license")])),_:1}),s[10]||(s[10]=i()),s[11]||(s[11]=a("a",{class:"header-anchor",href:"#license","aria-label":`Permalink to "<font color='#f14158'>license</font>"`},"​",-1))]),s[43]||(s[43]=a("ul",null,[a("li",null,"指定开源许可证类型（如 MIT、ISC）"),a("li",null,[i("如果不想开源，将其设置为 "),a("code",null,"UNLICENSED"),i("，否则可能报错。")])],-1)),a("h3",m,[l(n,{color:"#f14158"},{default:e(()=>s[12]||(s[12]=[i("files")])),_:1}),s[13]||(s[13]=i()),s[14]||(s[14]=a("a",{class:"header-anchor",href:"#files","aria-label":`Permalink to "<font color='#f14158'>files</font>"`},"​",-1))]),s[44]||(s[44]=t(`<ul><li>明确列出需要发布的文件或目录，避免无关内容被上传。例如：测试文件</li></ul><p>示例：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;files&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;dist&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;es&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;lib&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;README.md&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div>`,3)),a("h3",E,[l(n,{color:"#f14158"},{default:e(()=>s[15]||(s[15]=[i("publishConfig")])),_:1}),s[16]||(s[16]=i()),s[17]||(s[17]=a("a",{class:"header-anchor",href:"#publishconfig","aria-label":`Permalink to "<font color='#f14158'>publishConfig</font>"`},"​",-1))]),s[45]||(s[45]=t(`<ul><li>自定义发布时的配置，例如： <ul><li><code>registry</code>：指定发布的注册表地址</li><li><code>access</code>: 公开性设置（<code>public</code> 或 <code>restricted</code>）</li></ul></li></ul><p>示例：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;publishConfig&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;registry&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://registry.npmjs.org/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;access&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;public&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="package-json-推荐字段" tabindex="-1">package.json 推荐字段 <a class="header-anchor" href="#package-json-推荐字段" aria-label="Permalink to &quot;package.json 推荐字段&quot;">​</a></h2>`,4)),a("h3",c,[l(n,{color:"#30a46c"},{default:e(()=>s[18]||(s[18]=[i("description")])),_:1}),s[19]||(s[19]=i()),s[20]||(s[20]=a("a",{class:"header-anchor",href:"#description","aria-label":`Permalink to "<font color='#30a46c'>description</font>"`},"​",-1))]),s[46]||(s[46]=a("p",null,"对包的简短描述，用于 NPM 网站显示",-1)),a("h3",f,[l(n,{color:"#30a46c"},{default:e(()=>s[21]||(s[21]=[i("keywords")])),_:1}),s[22]||(s[22]=i()),s[23]||(s[23]=a("a",{class:"header-anchor",href:"#keywords","aria-label":`Permalink to "<font color='#30a46c'>keywords</font>"`},"​",-1))]),s[47]||(s[47]=a("p",null,"关键字数组，方便用户在 NPM 搜索中找到你的包",-1)),a("h3",q,[l(n,{color:"#30a46c"},{default:e(()=>s[24]||(s[24]=[i("repository")])),_:1}),s[25]||(s[25]=i()),s[26]||(s[26]=a("a",{class:"header-anchor",href:"#repository","aria-label":`Permalink to "<font color='#30a46c'>repository</font>"`},"​",-1))]),s[48]||(s[48]=t(`<p>包的代码仓库地址。</p><p>示例：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;repository&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;git&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://github.com/your-username/your-repo.git&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,3)),a("h3",y,[l(n,{color:"#30a46c"},{default:e(()=>s[27]||(s[27]=[i("homepage")])),_:1}),s[28]||(s[28]=i()),s[29]||(s[29]=a("a",{class:"header-anchor",href:"#homepage","aria-label":`Permalink to "<font color='#30a46c'>homepage</font>"`},"​",-1))]),s[49]||(s[49]=a("p",null,"包的官网地址",-1)),a("h3",F,[l(n,{color:"#30a46c"},{default:e(()=>s[30]||(s[30]=[i("bugs")])),_:1}),s[31]||(s[31]=i()),s[32]||(s[32]=a("a",{class:"header-anchor",href:"#bugs","aria-label":`Permalink to "<font color='#30a46c'>bugs</font>"`},"​",-1))]),s[50]||(s[50]=t(`<p>提交 Bug 报告的地址。</p><p>示例：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;bugs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://github.com/your-username/your-repo/issues&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div>`,3)),a("h3",v,[l(n,{color:"#30a46c"},{default:e(()=>s[33]||(s[33]=[i("engines")])),_:1}),s[34]||(s[34]=i()),s[35]||(s[35]=a("a",{class:"header-anchor",href:"#engines","aria-label":`Permalink to "<font color='#30a46c'>engines</font>"`},"​",-1))]),s[51]||(s[51]=t(`<p>指定支持的 Node.js 或 npm 版本。</p><p>示例：</p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;engines&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;node&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&gt;=14&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;npm&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&gt;=6&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h2><h3 id="版本冲突" tabindex="-1">版本冲突 <a class="header-anchor" href="#版本冲突" aria-label="Permalink to &quot;版本冲突&quot;">​</a></h3><p><code>You cannot publish over the previously published versions.</code></p><p><strong>原因：说明版本已经存在，请及时更新版本。</strong></p><h3 id="权限不足" tabindex="-1">权限不足 <a class="header-anchor" href="#权限不足" aria-label="Permalink to &quot;权限不足&quot;">​</a></h3><p><code>You do not have permission to publish this package.</code></p><p><strong>原因： 当前用户没有发布权限</strong></p><h3 id="文件超大" tabindex="-1">文件超大 <a class="header-anchor" href="#文件超大" aria-label="Permalink to &quot;文件超大&quot;">​</a></h3><p><code>npm ERR! code ENEEDAUTH 或 Tarball too large.</code></p><p><strong>原因： 未正确设置 files 字段或 .npmignore 文件</strong></p><h3 id="注册表问题" tabindex="-1">注册表问题 <a class="header-anchor" href="#注册表问题" aria-label="Permalink to &quot;注册表问题&quot;">​</a></h3><p><code>npm ERR! 404 Not Found 或 npm ERR! ENOTFOUND</code></p><p><strong>原因： 注册表配置有误或未联网</strong></p><h2 id="npm-publish-的执行流程" tabindex="-1">npm publish 的执行流程 <a class="header-anchor" href="#npm-publish-的执行流程" aria-label="Permalink to &quot;npm publish 的执行流程&quot;">​</a></h2><h3 id="_1、检查当前目录" tabindex="-1">1、检查当前目录 <a class="header-anchor" href="#_1、检查当前目录" aria-label="Permalink to &quot;1、检查当前目录&quot;">​</a></h3><blockquote><ul><li>确保当前目录包含 package.json 文件，否则会报错。</li><li>检查项目结构，忽略不必要的文件（使用 .npmignore 或 .gitignore）,以便减少上传体积</li></ul></blockquote><h3 id="_2、验证package-json" tabindex="-1">2、验证package.json <a class="header-anchor" href="#_2、验证package-json" aria-label="Permalink to &quot;2、验证package.json&quot;">​</a></h3><blockquote><ul><li>确保 package.json 中的必要字段正确且有效</li></ul></blockquote><h3 id="_3、运行钩子脚本" tabindex="-1">3、运行钩子脚本 <a class="header-anchor" href="#_3、运行钩子脚本" aria-label="Permalink to &quot;3、运行钩子脚本&quot;">​</a></h3><blockquote><ul><li>执行 scripts 中定义的钩子脚本</li></ul></blockquote><p>例如：</p><div class="language-plaintext vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>prepare：安装时和发布前运行（常用于打包构建）</span></span>
<span class="line"><span>prepublishOnly：仅发布前运行（不会在 npm install 中触发）</span></span>
<span class="line"><span>postpublish：发布后运行（用于通知、清理等）</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4、检查版本号" tabindex="-1">4、检查版本号 <a class="header-anchor" href="#_4、检查版本号" aria-label="Permalink to &quot;4、检查版本号&quot;">​</a></h3><blockquote><ul><li>对比 package.json 中的 version 和远程注册表的版本，如果当前版本已存在，npm publish 会被拒绝。</li></ul></blockquote><h3 id="_5、打包项目" tabindex="-1">5、打包项目 <a class="header-anchor" href="#_5、打包项目" aria-label="Permalink to &quot;5、打包项目&quot;">​</a></h3><blockquote><p>将所有符合条件的文件打包成 <code>.tgz </code>文件，准备上传.</p></blockquote>`,29)),l(n,{color:"#f14158"},{default:e(()=>s[36]||(s[36]=[i("打包的文件包括:")])),_:1}),a("p",null,[a("strong",null,[l(n,{color:"#f14158"},{default:e(()=>s[37]||(s[37]=[i("files 字段中列出的文件, 未被 .npmignore 或 .gitignore 排除的文件。")])),_:1})])]),s[52]||(s[52]=t('<h3 id="_6、权限验证" tabindex="-1">6、权限验证 <a class="header-anchor" href="#_6、权限验证" aria-label="Permalink to &quot;6、权限验证&quot;">​</a></h3><blockquote><ul><li>确保当前用户拥有发布到该 package 或 scope 的权限</li></ul></blockquote><h3 id="_7、上传到npm" tabindex="-1">7、上传到npm <a class="header-anchor" href="#_7、上传到npm" aria-label="Permalink to &quot;7、上传到npm&quot;">​</a></h3><blockquote><p>默认上传到 <a href="https://registry.npmjs.org" target="_blank" rel="noreferrer">https://registry.npmjs.org</a>，如果 .npmrc 中配置了其他注册表地址，则上传到自定义注册表。 成功上传后，包会立即可用。</p></blockquote><h2 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h2><blockquote><ul><li>优化包的大小(可执行<code>npm pack --dry-run</code>检查发表内容)</li><li>自动化发布流程</li><li>确保代码质量</li><li>scoped包名 (对团队开发项目，建议使用 Scoped 包名（如 @your-scope/package-name）, 便于管理和权限控制)</li></ul></blockquote>',6))])}const S=o(u,[["render",C]]);export{R as __pageData,S as default};
